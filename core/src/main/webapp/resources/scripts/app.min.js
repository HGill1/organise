var japp=japp||{};var pageStart=1;var imageLoadCheck=0;var subtopicArray=new Array();japp.global=window;japp.document=window.document;japp.body=window.document.body;japp.selectBoxes=function(){if(!(jQuery.browser.msie===true&&jQuery.browser.version==="7.0")){jQuery("select[data-custom=true]").selectBox()}};japp.layout=japp.layout||{};japp.layout.bodyHeight=function(){return jQuery("body").innerHeight()-5};japp.layout.colsHeight=function(){var a=japp.layout.bodyHeight(),d=jQuery("#contentLeft"),c=jQuery("#contentLeftScroll"),b=jQuery("#contentRight"),e=jQuery("#contentRightScroll");if(d.size()>0||b.size()>0){d.height(a-64);b.height(a-59)}if(c.size()>0||e.size()>0){c.height(jQuery(d).height()-54);e.height(jQuery(b).height()-65)}};japp.layout.scrollShadow=function(){var g=japp.layout.bodyHeight(),a=jQuery("#contentLeft"),f=jQuery("#contentLeftScroll"),h=jQuery("#contentRight"),i=jQuery("#contentRightScroll"),e=0,d=1,c=jQuery('<div class="right-scroll-shadow"></div>'),b=jQuery('<div class="right-scroll-shadow-bot"></div>');if(f.size()>0||i.size()>0){h.prepend(c);h.append(b);if((i[0].scrollHeight-i[0].clientHeight)>10){b.show()}else{b.hide()}c.hide();i.scroll(function(o){var C=(i[0].scrollHeight-i[0].clientHeight)-jQuery(o.target).scrollTop();var s=jQuery("[data-control=replyForm]"),E=s.parents("[data-control=replyWrapper]");if(E&&E.hasClass("show")){d=0}else{d=1}if(jQuery(o.target).scrollTop()>10){if(e===0){c.show();e=1}}if(jQuery(o.target).scrollTop()<10){c.hide();e=0}if(C<10){if(imageLoadCheck==0){if(d===1){b.hide();d=0;var D=(pageStart*15);var w=$("#filterCatId").val();var F=$("#filterUserId").val();var A=$("#filterStatusId").val();var n=$("#multiSourceFilter").val();var v=$("#myAddedTasksClicked").val();var k=$("#urgentClicked").val();var x=$("#orderBy").val();var t=$("#searching").val();var j="%"+$("#searchBox").val()+"%";var u=null;var y=false;var m=false;var q=false;var B=false;var l=false;var r=$("#displayAllUsersTasks").val();$container=$("#contentContainer");if($container.find("#noRecords").length==0){$container.children(".campaign-line").removeClass("active")}$container.append('<div id="imgLoader" style="width: 10%; margin:auto;"><img src="resources/images/ajax-loader-l.gif" alt="loading..." title="loading..."  /></div>');imageLoadCheck=1;if(w!="0"||F!="0"||A!="0"||n!="false"||v!="false"){}else{if(document.URL.indexOf("displayOldTasksPending")>-1){y=true}if(document.URL.indexOf("displayTodaysDueTasks")>-1){m=true}if(document.URL.indexOf("displayUrgentTasks")>-1){q=true}if(document.URL.indexOf("displayTodaysTasksPending")>-1){B=true}if(document.URL.indexOf("displayAllMyTasks")>-1){l=true}}if(t=="true"){searchFeeds(j,D,true)}else{if(n=="true"){u=$("#hiddenUserId").val();multiSourceFilterFeeds(u,D,true)}else{if(followingByCat=="true"){var p=$("#hiddenUserId").val();var z=$("#followCatId").val();followedTasksInCat(z,p,D,true)}else{if(k=="true"){filterFeeds(w,F,A,k,D,true,u,x)}else{if(y){u=$("#hiddenUserId").val();displayOldTasksPending(u,D,true)}else{if(m){u=$("#hiddenUserId").val();displayTodaysDueTasks(u,D,true)}else{if(q){u=$("#hiddenUserId").val();displayUrgentTasks(u,D,true)}else{if(B){u=$("#hiddenUserId").val();displayTodaysTasksPending(u,D,true)}else{if(l||r=="true"){u=$("#hiddenUserId").val();displayAllMyTasks(u,D,true,x)}else{if(v=="true"){u=$("#hiddenUserId").val();filterFeeds(w,F,A,k,D,true,u,x)}else{filterFeeds(w,F,A,k,D,true,u,x)}}}}}}}}}}pageStart=pageStart+1}}}else{if(d===0){b.show();d=1}}})}};japp.userDropDown=function(){var b=jQuery("[data-control=userMenuBtn]"),c=jQuery("[data-control=userMenuCreateBtn]"),e=jQuery("[data-control=userMenuEditBtn]"),d=jQuery("[data-control=userDropdownCancel]"),a=jQuery("[data-control=userMenu]");if(b.size()===0&&a.size()===0){return}b.live("click",function(f){f.preventDefault();f.stopPropagation();if(jQuery(this).is(".active")){japp.userDropDownReset();a.removeClass("show").slideUp();jQuery(this).removeClass("active")}else{jQuery(this).addClass("active");a.removeClass("hide").slideDown()}});a.bind("clickoutside",function(f){japp.userDropDownReset();jQuery(this).removeClass("show").slideUp();b.removeClass("active")});c.live("click",function(f){var g=jQuery("[data-control=userMenuCreate]");f.preventDefault();f.stopPropagation();japp.userDropDownReset(g);g.removeClass("hide").addClass("show")});e.live("click",function(f){var g=jQuery("[data-control=userMenuEdit]");f.preventDefault();f.stopPropagation();japp.userDropDownReset(g);g.removeClass("hide").addClass("show")});d.live("click",function(f){f.preventDefault();f.stopPropagation();japp.userDropDownReset()})};japp.userDropDownReset=function(b){var c=jQuery("[data-control=userMenu] > .user-dropdown-content"),a=jQuery(b);if(a.size()!==0){c.not(a).removeClass("show").addClass("hide")}else{c.each(function(d){var e=c[d];if(d===0){jQuery(e).removeClass("hide")}else{jQuery(e).removeClass("show").addClass("hide")}})}};japp.helpDropDown=function(){var b=jQuery("[data-control=helpBtn]"),a=jQuery("[data-control=helpMenu]");if(b.size()===0&&a.size()===0){return}b.live("click",function(c){c.preventDefault();c.stopPropagation();if(jQuery(this).is(".active")){a.removeClass("show").slideUp();jQuery(this).removeClass("active")}else{jQuery(this).addClass("active");a.removeClass("hide").slideDown()}});a.bind("clickoutside",function(c){jQuery(this).removeClass("show").slideUp();b.removeClass("active")})};japp.tasksDropDown=function(){var b=jQuery("[data-control=tasksMenuBtn]"),a=jQuery("[data-control=tasksMenu]");if(b.size()===0&&a.size()===0){return}b.live("click",function(c){c.preventDefault();c.stopPropagation();if(jQuery(this).is(".active")){a.removeClass("show").slideUp();jQuery(this).removeClass("active")}else{jQuery(this).addClass("active");a.removeClass("hide").slideDown()}});a.bind("clickoutside",function(c){jQuery(this).removeClass("show").slideUp();b.removeClass("active")})};japp.campaign=japp.campaign||{};japp.campaign.showAddForm=function(){var b=jQuery("#toggleAddForm"),a=jQuery("#dialogAddTask");a.dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",width:393,modal:true});if(b.size()===0||a.size()===0){return}b.on("click",function(c){c.preventDefault();a.dialog("open")});a.find(".cancelBtn").live("click",function(c){c.preventDefault();c.stopPropagation();japp.campaign.cancelAddCampaign()})};japp.campaign.cancelAddCampaign=function(){jQuery("#dialogAddTask").dialog("close")};japp.campaign.bindButtons=function(){japp.campaign.bindReply();japp.campaign.moreBind();japp.campaign.bindEditCampaign();japp.campaign.bindDeleteCampaign();japp.campaign.bindEditComment()};japp.campaign.bindReply=function(){if(jQuery("[data-control=replyBtn]").size()===0){return}jQuery("[data-control=replyBtn]").each(function(){jQuery(this).live("click",function(h){h.preventDefault();h.stopPropagation();$("#parentId").val($(this).attr("id"));$("#reassignTaskBlock").removeClass("hide");var l=$(this).children("input:hidden").map(function(){return this.value}).get();var c=l[0],g=l[1],d=l[2],f=l[3],i=l[4],k=l[5],b=l[6],j=l[7],a=l[8];assignToDept=l[9];$("#sourceId").val(c);$("#assignToId").val(g);$("#taskAssignerEmail").val(d);$("#replyPostCommentEmailNotify").val(f);$("#replyAssignToName").val(i);$("#replyAssignerName").val(k);$("#replyTaskTitle").val(b);$("#taskAssignerId").val(j);$("#taskAssignToEmail").val(a);$("#assignToDept").val(assignToDept);japp.campaign.showReply(jQuery(this))})});jQuery("[data-control=hideReply]").live("click",function(a){a.preventDefault();a.stopPropagation();japp.campaign.hideReply()})};japp.campaign.showReply=function(a){var b={};b.replyBtn=jQuery(a);b.parent=jQuery(b.replyBtn).parents("[data-control=campaignMore]");b.formContainer=jQuery("[data-control=replyWrapper]",b.parent);b.replyForm=jQuery("[data-control=replyForm]");if(b.parent.size()===0||b.replyForm.size()===0){return}b.replyBtn.addClass("hide");b.formContainer.append(b.replyForm);b.replyForm.removeClass("hide");b.formContainer.removeClass("hide").addClass("show")};japp.campaign.hideReply=function(){var b=jQuery("[data-control=replyForm]"),a=b.parents("[data-control=replyWrapper]");if(a&&a.hasClass("show")){a.removeClass("show").addClass("hide");jQuery(".hide[data-control=replyBtn]").removeClass("hide");b.addClass("hide");jQuery(japp.body).append(b)}};japp.campaign.bindEditCampaign=function(){jQuery("#dialogEditCampaign").dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",width:393,modal:true});if(jQuery("[data-control=editCampaign]").size()===0){return}var a=japp;jQuery("[data-control=editCampaign]").each(function(){var b=jQuery(this);b.live("click",function(c){c.preventDefault();c.stopPropagation();a.campaign.startEditCampaign(b)})})};japp.campaign.startEditCampaign=function(a){var b={},c;b.editBtn=jQuery(a);b.parent=jQuery(b.editBtn).parents("[data-control=campaignWrapper]");b.dialog=jQuery("#dialogEditCampaign");b.dialog.dialog("open");b.dialog.find(".cancelBtn").live("click",function(d){d.preventDefault();d.stopPropagation();japp.campaign.cancelEditCampaign()})};japp.campaign.cancelEditCampaign=function(){jQuery("#dialogEditCampaign").dialog("close")};japp.campaign.bindDeleteCampaign=function(){jQuery("#dialogDel").dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",height:140,modal:true,buttons:{Delete:function(){jQuery(this).dialog("close");deleteId=$("#deletedId").val();deleteFeed(deleteId)},Cancel:function(){jQuery(this).dialog("close")}}});if(jQuery("[data-control=delCampaign]").size()===0){return}var a=japp;jQuery("[data-control=msgBox]").each(function(){var b=jQuery(this);jQuery("[data-control=delCampaign]",b).each(function(){var c=jQuery(this);c.live("click",function(d){d.preventDefault();d.stopPropagation();a.campaign.deleteCampaign(c)})})})};japp.campaign.deleteCampaign=function(a){var b={};b.delBtn=jQuery(a);b.parent=jQuery(b.delBtn).parents("[data-control=campaignWrapper]");val=b.delBtn.find("input[type=hidden]").val();jQuery("#deletedId").remove();jQuery("#dialogDel").dialog("open");jQuery("#dialogDel").append('<input type="hidden" id="deletedId" value='+val+">")};japp.campaign.bindEditComment=function(){jQuery("#dialogEditComment").dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",width:375,modal:true});if(jQuery("[data-control=editComment]").size()===0){return}var a=japp;jQuery("[data-control=commentsBox]").each(function(){var b=jQuery(this);jQuery("[data-control=editComment]",b).each(function(){var c=jQuery(this);c.live("click",function(d){d.preventDefault();d.stopPropagation();a.campaign.startEditComment(c)})})})};japp.campaign.startEditComment=function(a){var b={},c;b.editBtn=jQuery(a);b.parent=jQuery(b.editBtn).parents(".campaign-comment");jQuery("#dialogEditComment").dialog("open")};japp.campaign.cancelEditComment=function(){jQuery("#dialogEditComment").dialog("close")};japp.bindAddRegion=function(){var b=jQuery("[data-control=userMenuRegion]"),a=jQuery("#dialogAddRegion");a.dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",width:490,modal:true});if(b.size()===0||a.size()===0){return}b.on("click",function(c){c.preventDefault();a.dialog("open")});a.find(".cancelBtn").live("click",function(c){c.preventDefault();c.stopPropagation();a.dialog("close")})};japp.addRegions=function(){if(jQuery("[data-control=regionAddField]").size()===0){return false}var d=jQuery("[data-control=regionAddField]"),f=jQuery("input[type=text]",d),a=jQuery("input[type=reset]",d),e=jQuery("button",d),c,b;jQuery("[data-control=regionEdit]").live("click",function(g){g.preventDefault();g.stopPropagation();var h=$(this);b=h.parent().find("input:hidden").val();c=h.closest("tr").children("td:first");f=h.parents(".dialog-region-content").find("input[type=text]"),regionName=c.text();f.val(regionName);e.text("edit")});a.click(function(){e.text("add")});e.click(function(){var h=$(this),i=h.prev("input[type=text]"),g=h.parents(".dialog-region-content").find("[data-control=regionEditList]"),j=h.closest("form").attr("action");objAdd=(j=="addDept")?{name:i.val()}:{regionName:i.val()};objEdit=(j=="addDept")?{id:b,name:i.val()}:{id:b,regionName:i.val()};if(h.text()=="add"&&$.trim(i.val())!==""){g.append('<tr><td class="regionName">'+i.val()+'</td><td class="region-edit-btns" data-control="region-edit-del"><a href="#" data-control="regionEdit">Edit</a><a href="#" data-control="delRegion">Delete</a></td></tr>');$.post(j,objAdd,function(l){var k=g.find("tr:last").find("td:last");k.prepend('<input type="hidden" name="region-id" id="region-id" class="region-id" value ="'+l+'"/>')});i.val("")}if(h.text()=="edit"&&$.trim(i.val())!==""){editAction=(j=="addDept")?"editDept":"editRegion";$.post(editAction,objEdit,function(k){console.log(k)});c.text(i.val());i.val("");e.text("add")}})};japp.campaign.moreBind=function(){if(jQuery("[data-control=campaignShowMore]").size()===0){return}jQuery("[data-control=campaignShowMore]").each(function(){jQuery(this).find("a").live("click",function(a){a.preventDefault()});jQuery(this).live("click",function(a){a.preventDefault();a.stopPropagation();viewerId=$("#hiddenUserId").val();catId=jQuery(this).find("input[type=hidden]").val();updateRecentlyViewed(viewerId,catId);japp.campaign.moreShow(jQuery(this))})})};japp.campaign.moreShow=function(a){var b={};b.moreBtn=jQuery(a);b.parent=b.moreBtn.parents("[data-control=campaignWrapper]");japp.campaign.moreShowReset(b.parent);b.parent.addClass("active")};japp.campaign.moreShowReset=function(b){var a=jQuery(b);japp.campaign.hideReply();a.siblings(".active").removeClass("active")};japp.campaign.bindEditLeftNav=function(){var a=jQuery("[data-control=editLeftNav]");if(a.size()===0){return}a.live("click",function(){if(jQuery(this).is(".active")){japp.campaign.hideEditLeftNav(jQuery(this))}else{japp.campaign.showEditLeftNav(jQuery(this))}})};japp.campaign.showEditLeftNav=function(a){var c=a,b={};b.wrapper=jQuery("[data-control=leftNavFolders]");b.triggers=jQuery(".edit-row",b.wrapper);if(!b.wrapper.is(":visible")){return}b.wrapper.addClass("edit");b.triggers.each(function(){jQuery(this).live("click",function(d){d.preventDefault();d.stopPropagation();japp.campaign.bindLeftNavTriggers(jQuery(this))})})};japp.bindEditSubtopics=function(){if(jQuery("[data-control=subtopicAddField]").size()===0){return false}var c=jQuery("[data-control=subtopicAddField]"),d=jQuery("input[type=text]",c),a=jQuery(".btn-control",c),b=jQuery("[data-control=subtopicsEditList]");a.click(function(){b.append('<li><i class="icon-ball"><i style="background: #ffd200;"></i></i> <a id = "subtopicValues" href="#">'+d.val()+'</a><span class="edit-row"><a href="#" data-control="delSubtopics"></a></span></li>');subtopicArray.push(d.val());d.val("")});jQuery("[data-control=delSubtopics]").live("click",function(f){f.preventDefault();f.stopPropagation();delList=jQuery(this).parents("li");removeItem=delList.children("a").text();subtopicArray=jQuery.grep(subtopicArray,function(e){return e!=removeItem});jQuery(this).parents("li").remove()})};japp.campaign.bindLeftNavTriggers=function(a){var b=a,c=jQuery(b).parents("li");if(c.hasClass("gray")){c.removeClass("gray");b.html("Show");showHideTopic(c.children("input").attr("value"),$("#hiddenUserId").val(),"show")}else{c.addClass("gray");b.html("Hide");showHideTopic(c.children("input").attr("value"),$("#hiddenUserId").val(),"hide")}};japp.campaign.hideEditLeftNav=function(a){var c=a,b={};b.wrapper=jQuery("[data-control=leftNavFolders]");b.triggers=jQuery(".edit-row",b.wrapper);c.removeClass("active").find("span").remove();b.wrapper.removeClass("edit");b.triggers.each(function(){jQuery(this).unbind("click")})};japp.alertBox=function(){var a=jQuery("[data-control=alert]");if(jQuery("[data-control=alert]").size()===0){return}a.each(function(){jQuery(this).find("[data-control=alertClose]").click(japp.alertBoxClose)})};japp.alertBoxClose=function(a){var b=jQuery(this).parent("[data-control=alert]");b.hide()};japp.users=japp.users||{};japp.users.userItemsFixMargin=function(){$(".preferences.user-item-wrapper:nth-child(3n+1)").css("margin-right","0").find(".user-details").css("left","-52px")};japp.users.addFormBind=function(){if(jQuery("[data-control=addUserBtn]").size()===0){return}var a=japp;jQuery("[data-control=addUserBtn]").each(function(){jQuery(this).live("click",function(b){b.preventDefault();b.stopPropagation();if(jQuery(this).is(".active")){jQuery(this).removeClass("active");jQuery("[data-control=addUserForm]").removeClass("show").addClass("hide")}else{jQuery(this).addClass("active");jQuery("[data-control=addUserForm]").removeClass("hide").addClass("show")}})})};japp.users.bindEdit=function(){if(jQuery("[data-control=userBtn]").size()===0){return}var a=japp;jQuery("[data-control=userBtn]").each(function(){jQuery(this).live("click",function(b){b.preventDefault();b.stopPropagation();if(jQuery(this).is(".active")){a.users.hideUserBox(jQuery(this))}else{a.users.showUserBox(jQuery(this))}})});jQuery("[data-control=userInfoSaveButton]").each(function(){jQuery(this).live("click",function(b){b.preventDefault();b.stopPropagation();var c={};var d=$(this).closest("form").attr("id");modifyUserDept(d);c.userBtn=$(this).parents().find("[data-control=userBtn]");a.users.hideUserBox(c.userBtn)})});jQuery("[data-control=userInfoCancelButton]").each(function(){jQuery(this).live("click",function(b){b.preventDefault();b.stopPropagation();var c={};c.userBtn=$(this).parents().find("[data-control=userBtn]");a.users.hideUserBox(c.userBtn)})})};japp.users.bindUserInfoBox=function(){if(jQuery("[data-control=userDetails]").size()===0){return}var a=japp;jQuery("[data-control=userDetails]").each(function(){var b=jQuery(this);b.live("clickoutside",function(c){c.preventDefault();c.stopPropagation();a.users.hideUserBox(b)})})};japp.users.hideUserInfoBo=function(a){var b={};b.userInfoBox=jQuery(a);b.wrapper=jQuery(b.userInfoBox).parents("[data-control=userItemWrapper]");b.userBtn=jQuery(b.wrapper).find("[data-control=userBtn]");b.userBtnIcon=jQuery("i",b.userBtn);b.userBtn.removeClass("active");b.userBtnIcon.removeClass("up");b.userInfoBox.addClass("hide").removeClass("show");b.userInfoBox.removeClass("open")};japp.users.showUserBox=function(a){var b={},c;b.userBtn=jQuery(a);b.userBtnIcon=jQuery("i",b.userBtn);b.wrapper=jQuery(b.userBtn).parents("[data-control=userItemWrapper]");b.dropDown=jQuery(b.wrapper).find("[data-control=userDetails]");b.userBtnParent=jQuery(b.userBtn).parent();japp.users.resetUserBox();b.userBtn.addClass("active");b.userBtnIcon.addClass("up");b.wrapper.addClass("active");b.dropDown.addClass("show").removeClass("hide")};japp.users.hideUserBox=function(a){var b={};b.userBtn=jQuery(a);b.userBtnIcon=jQuery("i",b.userBtn);b.wrapper=jQuery(b.userBtn).parents("[data-control=userItemWrapper]");b.dropDown=jQuery(b.wrapper).find("[data-control=userDetails]");b.userBtnParent=jQuery(b.userBtn).parent();b.userBtn.removeClass("active");b.userBtnIcon.removeClass("up");b.dropDown.addClass("hide").removeClass("show");b.wrapper.removeClass("open")};japp.users.resetUserBox=function(){jQuery(".active[data-control=userBtn]").click()};japp.users.sortBind=function(){if(jQuery("[data-control=sortBtns]").size()===0){return}jQuery("[data-control=sortBtns]").buttonset()};japp.users.sourceBind=function(){if(jQuery("[data-control=userCheckBox]").size()===0){return}jQuery("[data-control=userCheckBox]").each(function(){jQuery(this).live("click",function(){if(jQuery(this).is(":checked")){japp.users.sourceMoveSeen(jQuery(this).parents("[data-control=userItemSource]"))}else{japp.users.sourceMoveAll(jQuery(this).parents("[data-control=userItemSource]"))}})})};japp.users.sourceMoveSeen=function(b){var a=jQuery("[data-control=userSeen]");a.append(b)};japp.users.sourceMoveAll=function(b){var a=jQuery("[data-control=userAll]");a.append(b)};japp.users.sourceSelectAll=function(){if(jQuery("[data-control=userSelectAll]").size()===0){return}jQuery("[data-control=userSelectAll]").live("click",function(){var a;if(jQuery(this).is(":checked")){a=jQuery("[data-control=userCheckBox]",jQuery("[data-control=userAll]"));a.each(function(){jQuery(this).attr("checked","checked");japp.users.sourceMoveSeen(jQuery(this).parents("[data-control=userItemSource]"))})}else{a=jQuery("[data-control=userCheckBox]",jQuery("[data-control=userSeen]"));a.each(function(){jQuery(this).removeAttr("checked");japp.users.sourceMoveAll(jQuery(this).parents("[data-control=userItemSource]"))})}})};japp.users.permissionsDropdown=function(){$(".user-add-permissions").on("click",function(a){a.preventDefault();var b=$(this).next("div");b.fadeToggle("fast");return false});jQuery("[data-control=topicsDropdown]").on("clickoutside",function(){$(this).fadeOut("fast")});jQuery("[data-control=deptDropdown]").on("clickoutside",function(){$(this).fadeOut("fast")});$(".user-add-permissions-options .user-permission-option").on("change",function(){if($(this).is(":checked")){$(this).next().addClass("activePermission")}else{$(this).next().removeClass("activePermission")}})};japp.users.bindDestroySource=function(){jQuery("#dialogDelSource").dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",height:140,modal:true,buttons:{Delete:function(){jQuery(this).dialog("close");deleteId=$("#deleteSourceId").val();deleteSource(deleteId)},Cancel:function(){jQuery(this).dialog("close")}}});if(jQuery("[data-control=sourceDestroy]").size()===0){return}var a=japp;jQuery("[data-control=sourceDestroy]").each(function(){var b=jQuery(this);b.live("click",function(c){c.preventDefault();c.stopPropagation();a.users.destroySource(b)})})};japp.users.destroySource=function(a){var b={};b.delBtn=jQuery(a);b.parent=jQuery(b.delBtn).parents("[data-control=sourceDestroy]");val=b.delBtn.find("input[type=hidden]").val();jQuery("#deleteSourceId").remove();jQuery("#dialogDelSource").dialog("open");jQuery("#dialogDelSource").append('<input type="hidden" id="deleteSourceId" value='+val+">")};japp.users.bindDestroyRegion=function(){jQuery("#dialogDelRegion").dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",height:140,modal:true,buttons:{Ok:function(){jQuery(this).dialog("close")}}});if(jQuery("[data-control=delRegion]").size()===0){return}var a=japp;jQuery("[data-control=delRegion]").live("click",function(b){b.preventDefault();b.stopPropagation();var c=jQuery(this);action=c.closest("form").attr("action");deleteAction=(action=="addDept")?"deleteDept":"deleteRegion";rId=c.parent().find("input:hidden").val();$.post(deleteAction,{id:rId},function(d){console.log(d);if(d!=0){b.preventDefault();b.stopPropagation();a.users.destroyRegion(c)}else{c.parents("tr").remove()}})})};japp.users.destroyRegion=function(a){jQuery("#dialogDelRegion").dialog("open")};japp.users.bindDestroyUser=function(){jQuery("#dialogDelUser").dialog({autoOpen:false,resizable:false,show:"fade",hide:"explode",height:140,modal:true,buttons:{Delete:function(){jQuery(this).dialog("close");deleteId=$("#deleteUserId").val();deleteUser(deleteId)},Cancel:function(){jQuery(this).dialog("close")}}});if(jQuery("[data-control=userDestroy]").size()===0){return}var a=japp;jQuery("[data-control=userDestroy]").each(function(){var b=jQuery(this);b.live("click",function(c){c.preventDefault();c.stopPropagation();a.users.destroyUser(b)})})};japp.users.destroyUser=function(a){var b={};b.delBtn=jQuery(a);b.parent=jQuery(b.delBtn).parents("[data-control=userDestroy]");val=b.delBtn.find("input[type=hidden]").val();jQuery("#deleteUserId").remove();jQuery("#dialogDelUser").dialog("open");jQuery("#dialogDelUser").append('<input type="hidden" id="deleteUserId" value='+val+">")};japp.datePicker=function(){if(jQuery("[data-control=datepicker]").size()===0){return}jQuery("[data-control=datepicker]").each(function(){var a=jQuery("[data-control=datepickerFrom]",this),b=jQuery("[data-control=datepickerTo]",this);if(b.size()===0){a.datepicker({numberOfMonths:1})}else{a.datepicker({numberOfMonths:1,onSelect:function(c){b.datepicker("option","minDate",c)}});b.datepicker({numberOfMonths:1,onSelect:function(c){a.datepicker("option","maxDate",c)}})}})};japp.placeholder=function(){jQuery(".ie7 input[type='text'], .ie8 input[type='text'], .ie9 input[type='text']").each(function(){if(jQuery(this).val()==""&&jQuery(this).attr("placeholder")!=""){jQuery(this).val(jQuery(this).attr("placeholder"));jQuery(this).focus(function(){if(jQuery(this).val()==jQuery(this).attr("placeholder")){jQuery(this).val("")}});jQuery(this).blur(function(){if(jQuery(this).val()==""){jQuery(this).val(jQuery(this).attr("placeholder"))}})}})};japp.accordionBind=function(){var a=jQuery("[data-control=leftExpander]");if(a.size()===0){return}a.live("click",function(){if(jQuery(this).is(".collapsed")){japp.accordionShow(jQuery(this))}else{japp.accordionHide(jQuery(this))}})};japp.accordionShow=function(a){jQuery(a).parent().next(".left-nav-sub").removeClass("accordion-hide").slideDown();jQuery(a).addClass("down").removeClass("collapsed")};japp.accordionHide=function(a){jQuery(a).parent().next(".left-nav-sub").slideUp();jQuery(a).removeClass("down").addClass("collapsed")};japp.accordionItemBind=function(){var a=jQuery("[data-control=dropdownExpander]");if(a.size()===0){return}a.live("click",function(b){b.preventDefault();b.stopPropagation();if(jQuery(this).is(".collapsed")){japp.accordionItemShow(jQuery(this))}else{japp.accordionItemHide(jQuery(this))}})};japp.accordionItemShow=function(a){jQuery(a).siblings(".left-nav-dropdown").removeClass("accordion-hide").slideDown();jQuery(a).addClass("down").removeClass("collapsed")};japp.accordionItemHide=function(a){jQuery(a).siblings(".left-nav-dropdown").slideUp();jQuery(a).removeClass("down").addClass("collapsed")};japp.status=function(){var a=jQuery("[data-control=statusItem]"),b=jQuery("[data-control=statusCurrent]");if(a.size()===0){return}a.each(function(){jQuery(this).live("click",function(){jQuery(this).siblings(".status-item").removeClass("active");jQuery(this).addClass("active");b.html("");jQuery(this).clone().appendTo(b);$("#replyStatus").val(jQuery(this).attr("id"));$("#replyStatus").data("replyStatus",jQuery(this).text());if(jQuery(this).attr("id")==4){$("#reassignTaskBlock").addClass("hide")}else{$("#reassignTaskBlock").removeClass("hide")}})})};japp.ajaxLoadingShow=function(a){jQuery(a).addClass("ajax-loading")};japp.ajaxLoadingHide=function(a){jQuery(a).removeClass("ajax-loading")};japp.colorPicker=function(){if(jQuery("[data-control=editColorBtn]").size()===0){return}jQuery("#editColorPicker").farbtastic("#editColor");jQuery("#editColorPicker").hide();jQuery("[data-control=editColorBtn]").each(function(){jQuery(this).live("click",function(a){a.preventDefault();a.stopPropagation();if(jQuery(this).is(".active")){jQuery("#editColorPicker").hide();jQuery(this).removeClass("active")}else{jQuery("#editColorPicker").show();jQuery(this).addClass("active")}})})};japp.pref=japp.pref||{};japp.pref.tabs=function(){$("#tabsPreferences").tabs();$("#tabsPreferences li").removeClass("ui-corner-top").addClass("ui-corner-left")};japp.autocompleteInput=function(){$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(a,c){var b=this,d="";$.each(c,function(f,e){if(e.category!=d){a.append("<li class='ui-autocomplete-category'>"+e.category+"</li>");d=e.category}b._renderItem(a,e)});a.append("<span class='arrowForAutocompleteBlock'>")}});$(".autocompleteContainer").each(function(){var b=[];var a=$(this);var c=$(this).parent().hasClass("autocompleteCrutch");a.find(".autocompleteGroupContainer").each(function(){var d=$(this);var e=d.find(".autocompleteGroupTitle").text();d.find(".autocompleteItem").each(function(){b.push({label:$(this).text(),itemId:$(this).attr("data-item-id"),category:e})})});if(c){$("#"+a.attr("data-autocomplete-target")).catcomplete({appendTo:"#"+a.parents(".autocompleteCrutch").attr("id"),delay:0,source:b,select:function(e,d){$("#"+a.attr("data-autocomplete-target")).attr("data-selected-item-id",d.item.itemId)}})}else{$("#"+a.attr("data-autocomplete-target")).catcomplete({delay:0,source:b,select:function(e,d){$("#"+a.attr("data-autocomplete-target")).attr("data-selected-item-id",d.item.itemId)}})}})};japp.init=function(){var a=japp;init();a.layout.colsHeight();a.layout.scrollShadow();a.placeholder();a.selectBoxes();a.userDropDown();a.helpDropDown();a.campaign.showAddForm();a.datePicker();a.alertBox();a.accordionBind();a.accordionItemBind();a.users.userItemsFixMargin();a.users.permissionsDropdown();a.users.sortBind();a.users.bindEdit();a.users.bindUserInfoBox();a.users.sourceBind();a.users.sourceSelectAll();a.users.bindDestroySource();a.users.bindDestroyRegion();a.campaign.bindEditCampaign();a.campaign.bindDeleteCampaign();a.users.bindDestroyUser();a.campaign.bindEditComment();a.campaign.moreBind();a.campaign.bindReply();a.campaign.bindEditLeftNav();a.status();a.colorPicker();a.tasksDropDown();a.bindEditSubtopics();a.bindAddRegion();a.addRegions();a.autocompleteInput();a.pref.tabs();a.users.addFormBind();$("#groupsTable").tablesorter()};jQuery(window).resize(japp.layout.colsHeight);jQuery(document).ready(japp.init);